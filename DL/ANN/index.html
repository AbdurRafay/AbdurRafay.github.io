  <html>
  <head>
    <style type="text/css">
    canvas {
          /*width: 100%;
          height: 97%;
          */background: pink;
        }
      </style>
      <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/5.1.2/math.min.js"></script>
      <script>
        data = {
          x: [ [1,2,3],  [4,5,6] ],
          y: [ [1,0,1] ] 
        }
        X = math.matrix(data.x);
        X = math.transpose( X.resize([X.size()[0]+1,X.size()[1]], 1) );
        Y = math.transpose( math.matrix(data.y) );
        numOfLayers = 1 + 1 + 1;
        lengthOfHiddenLayer = 2;
        // W1 = math.zeros(X.size()[1],lengthOfHiddenLayer);
        W1 = math.matrix([ [1,2],  [3,4], [5,6] ])
        W2 = math.matrix([ [7],  [8] ])
        W = [W1, W2];
        A1 = math.matrix([ [100,200], [300,400], [500,600] ])
        A2 = math.matrix([ [111], [222], [333] ])
        A = [math.transpose(X), A1, A2]
        width = window.outerWidth * 0.7;
        height = window.outerHeight * 0.7;
        // stage;
        neurons = [];
        neuronRadius = 50;
        function init() {
          var canvas = document.getElementById("demoCanvas");
          canvas.width = width;
          canvas.height = height;
          stage = new createjs.Stage("demoCanvas");

          var xSpace = width/(numOfLayers);
          
          for (var i = 0; i < numOfLayers; i++) {
            if (i == 0) {
              numOfNeurons = X.size()[1];
            }
            else if (i == numOfLayers-1) {
              numOfNeurons = Y.size()[1];
            } 
            else {
              numOfNeurons = lengthOfHiddenLayer;
            }
            neurons.push([]);
            for (var j = 0; j < numOfNeurons; j++) {
              neurons[i].push(addNeuron(i*xSpace + xSpace/2, j*height/numOfNeurons + height/numOfNeurons/2, neuronRadius));
              // console.log(i,j);
              if (i == 0) { 
                var connection = connectNeurons(getLocation(neurons[i][j], -neuronRadius*2, 0), neurons[i][j]);
                continue;
              }
              for(neuron in neurons[i-1]) {
                var connection = connectNeurons(neurons[i-1][neuron], neurons[i][j]);
              }
              if (i == numOfLayers-1) { 
                var connection = connectNeurons(neurons[i][j], getLocation(neurons[i][j], neuronRadius*2, 0));
              }            
            }
          }

          // var neuron1 = addNeuron(100, 100, 50, stage);
          // var neuron2 = addNeuron(100, 250, 50, stage);
          // var neuron3 = addNeuron(100, 400, 50, stage);

          // var neuron4 = addNeuron(400, 100, 50, stage);
          // var neuron5 = addNeuron(400, 250, 50, stage);
          // var neuron6 = addNeuron(400, 400, 50, stage);

          // var labels = labelConnection(neuron1, neuron4, "0", "1", stage);
          // simulateLabels(labels.inputText, labels.weightText, neuron1, neuron4, stage);

          X._data.forEach(function (sample, sampleIndex) {
            if (sampleIndex == 0) {

              sample.forEach(function (input, inputIndex) {
                var neuron = neurons[0][inputIndex];
                var dummyNeuron = getLocation(neuron, -neuronRadius*2, 0);
                var labels = labelConnection(dummyNeuron, neuron, input, "");
                simulateLabels(labels.inputText, labels.weightText, dummyNeuron, neuron);
              })

              // Usage!
              neurons.forEach(function (layer, layerIndex) {
                var toLayer = neurons[layerIndex+1]
                if (toLayer) {
                  layer.forEach(function (neuron, neuronIndex) {
                    toLayer.forEach(function (toNeuron, toNeuronIndex) {
                      sleep((layerIndex+1) * 5000).then(() => {
                        console.log(neuronIndex,toNeuronIndex)
                        var input = A[layerIndex]._data[neuronIndex][toNeuronIndex]
                        var weight = W[layerIndex]._data[neuronIndex][toNeuronIndex]
                        var labels = labelConnection(neuron, toNeuron,  input, weight);
                        simulateLabels(labels.inputText, labels.weightText, neuron, toNeuron);
                      })                        
                    })
                  })  
                }                              
              })
              // sample.forEach(function (input, inputIndex) {
              //   W1._data[inputIndex].forEach(function (weight, weightIndex) {
              //     var neuron = neurons[0][inputIndex];
              //     var toNeuron = neurons[1][weightIndex];
              //     var labels = labelConnection(neuron, toNeuron, input, weight);
              //     simulateLabels(labels.inputText, labels.weightText, neuron, toNeuron);
              //   })            
              // })
            } 
          })

          function sleep (time) {
            return new Promise((resolve) => setTimeout(resolve, time));
          }
          
          // var connection = connectNeurons(neuron1, neuron4, stage);
          // var connection = connectNeurons(neuron1, neuron5, stage);
          // var connection = connectNeurons(neuron1, neuron6, stage);

          // var connection = connectNeurons(neuron2, neuron4, stage);
          // var connection = connectNeurons(neuron2, neuron5, stage);
          // var connection = connectNeurons(neuron2, neuron6, stage);

          // var connection = connectNeurons(neuron3, neuron4, stage);
          // var connection = connectNeurons(neuron3, neuron5, stage);
          // var connection = connectNeurons(neuron3, neuron6, stage);

        }
        function addNeuron(x, y, r) {
          var circle = new createjs.Shape();
          circle.graphics.beginFill("DeepSkyBlue").drawCircle(0, 0, r);
          circle.x = x;
          circle.y = y;
          stage.addChild(circle);
          stage.update();
          return circle;
        }
        function connectNeurons(a, b) {
          var line = new createjs.Shape();
          line.graphics.beginStroke("DeepSkyBlue").moveTo(a.x, a.y).lineTo(b.x, b.y);
          stage.addChild(line);
          stage.update();
          return line;
        }
        function getLocation(loc, xDis, yDis) {
          return {
            x: loc.x+xDis,
            y: loc.y+yDis
          }
        }
        function labelConnection(a, b, input, weight) {
          var inputText = new createjs.Text(input, "30px Arial", "#ff7700");
          var weightText = new createjs.Text(weight, "30px Arial", "#7700ff");
          inputText.x = weightText.x = a.x;
          inputText.y = weightText.y = a.y;
          // angle in degrees
          var angleDeg = Math.atan2(b.y - a.y, b.x - a.x) * 180 / Math.PI;
          // inputText.rotation = weightText.rotation = angleDeg;
          inputText.textBaseline = "bottom";
          weightText.textBaseline = "top";
          inputText.textAlign = weightText.textAlign = "center";
          stage.addChild(inputText);
          stage.addChild(weightText);
          stage.update();
          return {inputText: inputText, weightText: weightText};
        }
        async function simulateLabels(input, weight, from, to) {
          duration = 5000;
          createjs.Tween.get(input, {loop: false})
          .to({x: to.x, y: to.y}, duration, createjs.Ease.getPowInOut(4))
          createjs.Tween.get(weight, {loop: false})
          .to({x: to.x, y: to.y}, duration, createjs.Ease.getPowInOut(4))

          createjs.Ticker.setFPS(60);
          createjs.Ticker.addEventListener("tick", stage);
        }
        function pause(button) {
          createjs.Ticker.removeEventListener("tick", stage)
        }
      </script>
    </head>
    <body onload="init();">
      <canvas id="demoCanvas"></canvas>
      <button onclick="pause(this)">Pause</button>
    </body>
    </html>